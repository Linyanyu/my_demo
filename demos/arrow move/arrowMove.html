<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>arrow move</title>
	<style type="text/css">
		.arrow,.arrowParent{
			position: absolute;
			left: 100px;
			top: 100px;
			width: 0;
			height: 0;
			border-right: 5px solid transparent;
			border-left: 5px solid transparent;
			border-bottom: 15px solid #000;
			transform: rotate(-22deg);
		}
		.arrow:before,.arrowParent:before{
			content: "";
		    width: 9px;
		    height: 2px;
		    background: #000;
		    display: block;
		    position: absolute;
		    left: -4px;
		    top: 16px;
		    transform: rotate(90deg);
		}
	</style>
</head>
<body>

	<div class="arrowParent" id="arrow"></div>

	<script type="text/javascript">
		
		window.onload = function () {
			var timer = 1;
			var pathList = [];
			var sonSum = 0;
			var maxSonSum = 10;
			var moveSonIndex = 0;
			var arrowInterval = 25;
			var resetStatus;

			document.onmousemove = function (e) {

				var mother = document.querySelector('#arrow'),
					posX = e.pageX - mother.offsetWidth/2,
					posY = e.pageY - mother.offsetWidth/2;

				if (timer == 1) {
					timer = 0;
					setTimeout(function () {
						timer = 1;

						pathList.push({
							X: posX,
							Y: posY
						})

						if (sonSum < maxSonSum) {
							makeSon(e.pageX,e.pageY);
						} else {
							moveSon();
						}
						
					}, arrowInterval);
				}
				
				mother.style.left = posX + 'px';
				mother.style.top = posY + 'px';
			}

			// 生成箭头
			function makeSon(x, y) {
				var pop = pathList.pop();
				var son = document.createElement('div');

				sonSum ++;

				son.id = 'arrow' + sonSum;
				son.className = 'arrow';
				son.style.left = pop.X + 'px';
				son.style.top = pop.Y + 'px';

				document.body.appendChild(son);
			}

			// 将箭头按鼠标路径移动
			function moveSon () {
				(moveSonIndex == maxSonSum) && (moveSonIndex =  0) ;

				var lastArrow = document.querySelectorAll('.arrow')[moveSonIndex],
					pop = pathList.pop();

				lastArrow.style.left = pop.X + 'px';
				lastArrow.style.top = pop.Y + 'px';

				moveSonIndex ++;

				clearTimeout(resetStatus);
				resetStatus = setTimeout(arrowReset,100);
			}

			// 重置箭头位置
			function arrowReset () {
				var mother = document.querySelector('#arrow'),
					arrows = document.querySelectorAll('.arrow');

				for (var i=0;i<arrows.length;i++) {
					arrows[i].style.left = mother.offsetLeft + 'px';
					arrows[i].style.top = mother.offsetTop + 'px';
				}
			}
		}
	</script>
</body>
</html>