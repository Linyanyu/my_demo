<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>arrow move</title>
	<link rel="stylesheet" type="text/css" href="../../assets/css/base.css">
	<style type="text/css">

		.arrow,.arrowParent{
			position: absolute;
			left: 50%;
			top: 50%;
			width: 0;
			height: 0;
			border-right: 5px solid transparent;
			border-left: 5px solid transparent;
			border-bottom: 15px solid #000;
			transform: rotate(-22deg);
		}
		.arrow:before,.arrowParent:before{
			content: "";
		    display: block;
		    position: absolute;
		    left: -4px;
		    top: 16px;
		    width: 9px;
		    height: 2px;
		    background: #000;
		    transform: rotate(90deg);
		}

		.arrow2,.arrowParent2{
			position: absolute;
			width: 8px;
			height: 2px;
			background: #000;
			transform: rotate(68deg);
		}
		.arrow2:before,.arrowParent2:before{
			content: "";
			position: absolute;
			left: -8px;
			top: -2px;
			width: 0;
			height: 0;
			border-left: 5px solid transparent;
		    border-right: 7px solid transparent;
		    border-top: 5px solid #000;
		    transform: rotate(-26deg);
		}
		.arrow2:after,.arrowParent2:after{
			content: "";
			position: absolute;
			left: -9px;
			top: -1px;
			width: 0;
			height: 0;
			border-left: 7px solid transparent;
		    border-right: 5px solid transparent;
		    border-bottom: 5px solid #000;
		    transform: rotate(22deg);
		}

		.arrow3,.arrowParent3{
			left: 50%;
			top: 50%;
			position: absolute;
			width: 0;
			height: 0;
			border-left: 5px solid transparent;
		    border-right: 7px solid transparent;
		    border-top: 5px solid #000;
		    transform: rotate(42deg);
		}
		.arrow3:before,.arrowParent3:before{
			content: "";
			position: absolute;
			left: -6px;
			top: -4px;
			width: 0;
			height: 0;
			border-left: 7px solid transparent;
		    border-right: 5px solid transparent;
		    border-bottom: 5px solid #000;
		    transform: rotate(54deg);
		}
		.arrow3:after,.arrowParent3:after{
			content: "";
		    position: absolute;
	        left: 1px;
    		top: -1px;
			width: 8px;
			height: 2px;
			background: #000;
    		transform: rotate(23deg);
		}
	</style>
</head>
<body>

	<div class="arrowParent" id="arrow"></div>

	<script type="text/javascript">
		
		window.onload = function () {
			var timer = 1;
			var pathList = [];
			var sonSum = 0;
			var maxSonSum = 5;
			var arrowInterval = 5;

			document.onmousemove = function (e) {
				//return false;

				var mother = document.querySelector('#arrow'),
					posX = e.pageX - mother.offsetWidth/2, // -3
					posY = e.pageY - mother.offsetWidth/2; // +8

				if (timer == 1) {
					timer = 0;
					setTimeout(function () {
						timer = 1;

						pathList.push({
							X: posX,
							Y: posY
						})

						if (sonSum < maxSonSum) {
							sonSum ++;
							makeSon(sonSum);
						} else {
							moveSon().excute();
						}
						
					}, 25);
				}
				
				mother.style.left = posX + 'px';
				mother.style.top = posY + 'px';
			}

			// 生成箭头
			function makeSon(index) {
				var pop = pathList.pop();
				var son = document.createElement('div');

				son.id = 'arrow' + index;
				son.className = 'arrow';
				son.style.left = pop.X + 'px';
				son.style.top = pop.Y + 'px';

				document.body.appendChild(son);
			}

			// 将箭头按鼠标路径移动
			function moveSon () {
				var resetStatus,
					pop = pathList.pop();

				return {
					moveSonIndex: 0,
					excute: function(){
						var lastArrow = document.querySelectorAll('.arrow')[this.moveSonIndex];
						(this.moveSonIndex == maxSonSum) && (this.moveSonIndex =  0) ;

						lastArrow.style.left = pop.X + 'px';
						lastArrow.style.top = pop.Y + 'px';

						this.moveSonIndex ++;

						clearTimeout(resetStatus);
						resetStatus = setTimeout(arrowReset,arrowInterval);
					}
				}
			}

			// 重置箭头位置
			function arrowReset () {
				var mother = document.querySelector('#arrow'),
					arrows = document.querySelectorAll('.arrow');

				for (var i=0;i<arrows.length;i++) {
					arrows[i].style.left = mother.offsetLeft + 'px';
					arrows[i].style.top = mother.offsetTop + 'px';
				}
			}
		}
	</script>
</body>
</html>